# ドメインランダム化

このドキュメントでは、Sim-to-Realギャップを軽減するためのドメインランダム化について説明します。

## 概要

ドメインランダム化は、合成データの多様性を高めることで、シミュレーション環境で学習したモデルを実環境に適用する際のギャップ（Sim-to-Realギャップ）を軽減する技術です。

YCB SynthForgeでは、以下の要素をランダム化しています。

## ランダム化項目

### 背景

| 項目 | 範囲 |
|------|------|
| 床テクスチャ | Wood, Concrete, Tiles, Marble, Metal, Fabric |
| 壁テクスチャ | Concrete, Plaster, Brick, Paint, Wallpaper |
| テーブル材質 | Wood, Metal, Plastic |

### 照明

| 項目 | 範囲 |
|------|------|
| 光源数 | 3-5個 |
| 色温度 | 2700K-6500K |
| 強度 | 800-2000W相当 |
| 影の柔らかさ | 0.3-0.9 |

### カメラ

| 項目 | 範囲 |
|------|------|
| 距離 | 0.4-2.0m |
| 仰角 | 10-70° |
| 方位角 | 0-360° |
| 露出 | EV -1.5〜+1.5 |
| ISO | 100-3200 |
| 被写界深度 | f/1.8-11.0 |

### マテリアル

| 項目 | 範囲 |
|------|------|
| 金属度 | 0.8-1.0 (金属物体) |
| 粗さ | 0.05-0.6 |
| 色相シフト | ±10° |

### オブジェクト

| 項目 | 範囲 |
|------|------|
| 位置 | X,Y: ±0.3m |
| 回転 | 0-360° (各軸) |
| スケール | ±5% |

## 設定方法

ドメインランダム化の設定は `scripts/blenderproc/config.yaml` で行います。

```yaml
camera:
  distance: [0.4, 0.9]          # [最小, 最大]
  elevation: [35, 65]           # 仰角の範囲
  azimuth: [0, 360]             # 方位角の範囲

lighting:
  num_lights: [3, 5]            # 光源数の範囲
  intensity: [800, 2000]        # 強度の範囲
  ambient: [0.4, 0.7]           # 環境光の範囲

placement:
  position:
    x_range: [-0.25, 0.25]      # X方向の配置範囲
    y_range: [-0.25, 0.25]      # Y方向の配置範囲
```

## 効果

ドメインランダム化により、以下の効果が期待できます：

1. **照明条件への頑健性**: 様々な照明環境でも安定した検出
2. **視点の多様性**: 異なる角度からの物体認識能力の向上
3. **背景の汎化**: 様々な背景テクスチャに対する適応力
4. **物体位置の一般化**: 画像内の任意の位置にある物体の検出

## 関連ドキュメント

- [設定ファイルガイド](configuration.md)
- [パイプライン実行](pipeline.md)
